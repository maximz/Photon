In statistics, the coefficient of determination, denoted "R"2, is used in the context of statistical models whose main purpose is the prediction of future outcomes on the basis of other related information. "R"2 is most often seen as a number between 0 and 1.0, used to describe how well a regression line fits a set of data. An "R"2 near 1.0 indicates that a regression line fits the data well, while an "R"2 closer to 0 indicates a regression line does not fit the data very well. It is the proportion of variability in a data set that is accounted for by the statistical model. It provides a measure of how well future outcomes are likely to be predicted by the model.
There are several different definitions of "R"2 which are only sometimes equivalent. One class of such cases includes that of linear regression. In this case, if an intercept is included then "R"2 is simply the square of the sample correlation coefficient between the outcomes and their predicted values; in the case of simple linear regression, it is thus the squared correlation between the outcomes and the values of the single regressor being used for prediction. If an intercept is included and the number of explanators is more than one, "R"2 is also referred to as the coefficient of multiple correlation. In such cases, the coefficient of determination ranges from 0 to 1. Important cases where the computational definition of "R"2 can yield negative values, depending on the definition used, arise where the predictions which are being compared to the corresponding outcomes have not been derived from a model-fitting procedure using those data, and where linear regression is conducted without including an intercept. Additionally, negative values of "R"2 may occur when fitting non-linear trends to data. In these instances, the mean of the data provides a fit to the data that is superior to that of the trend under this goodness of fit analysis.
Definitions.
A data set has values "yi", each of which has an associated modelled value "fi" (also sometimes referred to as "ŷi"). Here, the values "yi" are called the observed values and the modelled values "fi" are sometimes called the predicted values.
where "n" is the number of observations.
The notations formula_6 and formula_7 should be avoided, since in some texts their meaning is reversed to Residual sum of squares and Explained sum of squares, respectively.
The most general definition of the coefficient of determination is
Relation to unexplained variance.
In a general form, "R"2 can be seen to be related to the unexplained variance, since the second term compares the unexplained variance (variance of the model's errors) with the total variance (of the data). See fraction of variance unexplained.
As explained variance.
In some cases the total sum of squares equals the sum of the two other sums of squares defined above,
See partitioning in the general OLS model for a derivation of this result for one case where the relation holds. When this relation does hold, the above definition of "R"2 is equivalent to
In this form "R"2 is expressed as the ratio of the explained variance (variance of the model's predictions, which is "SS"reg / "n") to the total variance (sample variance of the dependent variable, which is "SS"tot / "n").
This partition of the sum of squares holds for instance when the model values ƒ"i" have been obtained by linear regression. A milder sufficient condition reads as follows: The model has the form
where the "q""i" are arbitrary values that may or may not depend on "i" or on other free parameters (the common choice "q""i" = "x""i" is just one special case), and the coefficients α and β are obtained by minimizing the residual sum of squares.
As squared correlation coefficient.
Similarly, in linear least squares regression with an estimated intercept term, "R"2 equals the square of the Pearson correlation coefficient between the observed and modeled (predicted) data values.
Under more general modeling conditions, where the predicted values might be generated from a model different than linear least squares regression, an "R"2 value can be calculated as the square of the correlation coefficient between the original and modeled data values. In this case, the value is not directly a measure of how good the modeled values are, but rather a measure of how good a predictor might be constructed from the modeled values (by creating a revised predictor of the form α + βƒ"i"). According to Everitt (2002, p. 78), this usage is specifically the definition of the term "coefficient of determination": the square of the correlation between two (general) variables.
Interpretation.
"R"2 is a statistic that will give some information about the goodness of fit of a model. In regression, the "R"2 coefficient of determination is a statistical measure of how well the regression line approximates the real data points. An "R"2 of 1.0 indicates that the regression line perfectly fits the data.
Values of "R"2 outside the range 0 to 1 can occur where it is used to measure the agreement between observed and modeled values and where the "modeled" values are not obtained by linear regression and depending on which formulation of "R"2 is used. If the first formula above is used, values can never be greater than one. If the second expression is used, there are no constraints on the values obtainable.
In many (but not all) instances where "R"2 is used, the predictors are calculated by ordinary least-squares regression: that is, by minimizing "SS"err. In this case R-squared increases as we increase the number of variables in the model ("R"2 will not decrease). This illustrates a drawback to one possible use of "R"2, where one might try to include more variables in the model until "there is no more improvement". This leads to the alternative approach of looking at the adjusted "R"2. The explanation of this statistic is almost the same as "R"2 but it penalizes the statistic as extra variables are included in the model. For cases other than fitting by ordinary least squares, the "R"2 statistic can be calculated as above and may still be a useful measure. If fitting is by weighted least squares or generalized least squares, alternative versions of R2 can be calculated appropriate to those statistical frameworks, while the "raw" "R"2 may still be useful if it is more easily interpreted. Values for "R"2 can be calculated for any type of predictive model, which need not have a statistical basis.
In a linear model.
Consider a linear model of the form
where, for the "i"th case, formula_14 is the response variable, formula_15 are "p" regressors, and formula_16 is a mean zero error term. The quantities formula_17 are unknown coefficients, whose values are estimated by least squares. The coefficient of determination "R"2 is a measure of the global fit of the model. Specifically, "R"2 is an element of [0, 1] and represents the proportion of variability in "Y""i" that may be attributed to some linear combination of the regressors (explanatory variables) in "X".
"R"2 is often interpreted as the proportion of response variation "explained" by the regressors in the model. Thus, "R"2 = 1 indicates that the fitted model explains all variability in formula_18, while "R"2 = 0 indicates no 'linear' relationship (for straight line regression, this means that the straight line model is a constant line (slope=0, intercept=formula_4) between the response variable and regressors). An interior value such as "R"2 = 0.7 may be interpreted as follows: "Seventy percent of the variation in the response variable can be explained by the explanatory variable. The remaining thirty percent can be attributed to unknown, lurking variables or inherent variability."
A caution that applies to "R"2, as to other statistical descriptions of correlation and association is that "correlation does not imply causation." In other words, while correlations may provide valuable clues regarding causal relationships among variables, a high correlation between two variables does not represent adequate evidence that changing one variable has resulted, or may result, from changes of other variables.
In case of a single regressor, fitted by least squares, "R"2 is the square of the Pearson product-moment correlation coefficient relating the regressor and the response variable. More generally, "R"2 is the square of the correlation between the constructed predictor and the response variable.
Inflation of "R"2.
In least squares regression, "R"2 is weakly increasing in the number of regressors in the model. As such, "R"2 alone cannot be used as a meaningful comparison of models with different numbers of independent variables. For a meaningful comparison between two models, an F-test can be performed on the residual sum of squares, similar to the F-tests in Granger causality, though this is not always appropriate. As a reminder of this, some authors denote "R"2 by "R""p"2, where "p" is the number of columns in "X" (the number of explanators including the constant).
The optimal value of the objective is weakly smaller as additional columns of formula_21 are added, by the fact that less constrained minimization leads to an optimal cost which is weakly smaller than more constrained minimization does. Given the previous conclusion and noting that formula_22 depends only on "y", the non-decreasing property of "R"2 follows directly from the definition above.
The intuitive reason that using an additional explanatory variable cannot lower the "R"2 is this: Minimizing formula_23 is equivalent to maximizing "R"2. When the extra variable is included, the data always have the option of giving it an estimated coefficient of zero, leaving the predicted values and the "R"2 unchanged. The only way that the optimization problem will give a non-zero coefficient is if doing so improves the "R"2.
Adjusted "R"2.
The use of an adjusted "R"2 (often written as formula_24 and pronounced "R bar squared") is an attempt to take account of the phenomenon of statistical shrinkage—the tendency of models to perform less well out of sample than in sample. The adjusted "R"2 is a modification due to Theil of "R"2 that adjusts for the number of explanatory terms in a model relative to the number of data points. The adjusted "R"2 can be negative, and its value will always be less than or equal to that of "R"2. Unlike "R"2, the adjusted "R"2 increases when a new explanator is included only if the new explanator improves the "R"2 more than would be expected by chance. If a set of explanatory variables with a predetermined hierarchy of importance are introduced into a regression one at a time, with the adjusted "R"2 computed each time, the level at which adjusted "R"2 reaches a maximum, and decreases afterward, would be the regression with the ideal combination of having the best fit without excess/unnecessary terms. The adjusted "R"2 is defined as
where "p" is the total number of regressors in the linear model (not counting the constant term), and "n" is the sample size.
Adjusted "R"2 can also be written as
where "df""t" is the degrees of freedom "n"– 1 of the estimate of the population variance of the dependent variable, and "df""e" is the degrees of freedom "n" – "p" – 1 of the estimate of the underlying population error variance.
The principle behind the adjusted "R"2 statistic can be seen by rewriting the ordinary "R"2 as
where formula_28 and formula_29 are the sample variances of the estimated residuals and the dependent variable respectively, which can be seen as biased estimates of the population variances of the errors and of the dependent variable. These estimates are replaced by statistically unbiased versions: formula_30 and formula_31.
Adjusted "R"2 does not have the same interpretation as "R"2—while "R"2 is a measure of fit, adjusted "R"2 is a comparative measure of suitability of alternative numbers of explanators. As such, care must be taken in interpreting and reporting this statistic. Adjusted "R"2 is particularly useful in the feature selection stage of model building.
Generalized "R"2.
The generalized "R"² has all of these properties.
where "L"(0) is the likelihood of the model with only the intercept, formula_33 is the likelihood of the estimated model (i.e., the model with a given set of parameter estimates) and "n" is the sample size.
However, in the case of a logistic model, where formula_34 cannot be greater than 1, "R"² is between 0 and formula_35: thus, it is possible to define a scaled "R"² as "R"²/"R"²max.
